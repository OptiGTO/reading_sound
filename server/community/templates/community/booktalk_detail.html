<!-- community/templates/community/booktalk_detail.html -->     
{% extends "community/base.html" %}                                <!-- ë² ì´ìŠ¤ í…œí”Œë¦¿ í™•ì¥  // í™•ì¥ -->
{% load static %}                                                  <!-- ìŠ¤íƒœí‹± íŒŒì¼ ë¡œë“œ  // ìŠ¤íƒœí‹± íŒŒì¼ ë¡œë“œ -->

{% block title %}{{ post.title }}{% endblock %}                    <!-- í˜ì´ì§€ ì œëª©ì— ê²Œì‹œê¸€ ì œëª© ì‚¬ìš©  // ì œëª© ì‚¬ìš© -->

{% block content %}
<article class="post-detail">                                       <!-- ê²Œì‹œê¸€ ìƒì„¸ ì •ë³´ ì˜ì—­  // ê²Œì‹œê¸€ ìƒì„¸ ì˜ì—­ -->
  <h1>{{ post.title }}</h1>                                           <!-- ê²Œì‹œê¸€ ì œëª© ì¶œë ¥  // ì œëª© ì¶œë ¥ -->
  <p>ì‘ì„±ì: {{ post.writer.username }}</p>                           <!-- ì‘ì„±ì ì •ë³´ ì¶œë ¥  // ì‘ì„±ì ì¶œë ¥ -->
  <div class="post-content">
    {{ post.content|safe }}                                           <!-- ë‚´ìš© ë Œë”ë§ (HTML í—ˆìš©)  // ë‚´ìš© ì¶œë ¥ -->
  </div>
  
  <!-- ê´€ë ¨ ì´ë¯¸ì§€ ì¶œë ¥ (ìˆëŠ” ê²½ìš°)  // ì´ë¯¸ì§€ ì¶œë ¥ -->
  {% if post.postimage_set.all %}
    <div class="post-images">
      {% for image in post.postimage_set.all %}
        <img src="{{ image.image.url }}" alt="ê²Œì‹œê¸€ ì´ë¯¸ì§€" style="max-width: 300px;">  <!-- ì´ë¯¸ì§€ íƒœê·¸  // ì´ë¯¸ì§€ íƒœê·¸ -->
      {% endfor %}
    </div>
  {% endif %}
  
  <!-- ì¢‹ì•„ìš”(í•˜ëª¨ë‹ˆ) ë²„íŠ¼  // ì¢‹ì•„ìš” ë²„íŠ¼ -->
  <div class="like-container" style="margin-top:20px;">             <!-- ë²„íŠ¼ ê°ì‹¸ëŠ” ì˜ì—­  // ê°ì‹¸ëŠ” ì˜ì—­ -->
    <button id="like-btn" 
            data-post-id="{{ post.id }}" 
            data-model="BookTalkEventPost"> 
      ğŸµ í•˜ëª¨ë‹ˆ(ì¢‹ì•„ìš”) <span id="like-count">{{ post.likes }}</span>  <!-- ì•„ì´ì½˜ ë° ì¢‹ì•„ìš” ìˆ˜  // ì¢‹ì•„ìš” ìˆ˜ -->
    </button>
  </div>
  
  <a href="{% url 'community:home' %}" class="btn hover-effect" style="margin-top:20px; display:inline-block;">ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>   <!-- ëª©ë¡ ë³µê·€ ë²„íŠ¼  // ë³µê·€ ë²„íŠ¼ -->
</article>

<script>                                                              <!-- ìë°”ìŠ¤í¬ë¦½íŠ¸ ì‹œì‘  // ì‹œì‘ -->
  document.getElementById('like-btn').addEventListener('click', function(){  // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡  // ë¦¬ìŠ¤ë„ˆ ë“±ë¡
    const postId = this.dataset.postId;                               // ê²Œì‹œê¸€ ID ì¶”ì¶œ  // ì¶”ì¶œ
    const modelName = this.dataset.model;                             // ëª¨ë¸ëª… ì¶”ì¶œ  // ì¶”ì¶œ
    fetch("{% url 'community:like_post' %}", {                          // API ì—”ë“œí¬ì¸íŠ¸ í˜¸ì¶œ  // í˜¸ì¶œ
      method: 'POST',                                                 // POST ë©”ì„œë“œ  // ë©”ì„œë“œ ì§€ì •
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded'           // í—¤ë” ì„¤ì •  // í—¤ë” ì„¤ì •
      },
      body: `post_id=${postId}&model=${modelName}`                     // íŒŒë¼ë¯¸í„° ì „ì†¡  // íŒŒë¼ë¯¸í„° ì „ì†¡
    })
    .then(response => response.json())                                // ì‘ë‹µ JSON ë³€í™˜  // ë³€í™˜
    .then(data => {                                                   // ì‘ë‹µ ë°ì´í„° ì²˜ë¦¬  // ì²˜ë¦¬
      if(data.success){                                               // ì„±ê³µ ì‹œ  // ì„±ê³µ ì¡°ê±´
        document.getElementById('like-count').innerText = data.likes;   // ì¢‹ì•„ìš” ìˆ˜ ì—…ë°ì´íŠ¸  // ì—…ë°ì´íŠ¸
      } else {                                                        // ì‹¤íŒ¨ ì‹œ  // ì‹¤íŒ¨ ì¡°ê±´
        alert(data.error || 'ì¢‹ì•„ìš” ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');      // ì˜¤ë¥˜ ë©”ì‹œì§€ ì¶œë ¥  // ì¶œë ¥
      }
    })
    .catch(error => {                                                 // ì˜ˆì™¸ ì²˜ë¦¬  // ì²˜ë¦¬
      console.error('Error:', error);                                 // ì½˜ì†” ì˜¤ë¥˜ ì¶œë ¥  // ì¶œë ¥
      alert('ì¢‹ì•„ìš” ìš”ì²­ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');                      // ì‚¬ìš©ì ì˜¤ë¥˜ ì•Œë¦¼  // ì•Œë¦¼
    });
  });
</script>                                                             <!-- ìë°”ìŠ¤í¬ë¦½íŠ¸ ì¢…ë£Œ  // ì¢…ë£Œ -->
{% endblock %}