<!-- community/templates/community/general_post_detail.html -->     
{% extends "community/base.html" %}                                <!-- 베이스 템플릿 확장  // 확장 -->
{% load static %}                                                  <!-- 스태틱 파일 로드  // 스태틱 파일 로드 -->

{% block title %}{{ post.title }}{% endblock %}                    <!-- 페이지 제목에 게시글 제목 사용  // 제목 사용 -->

{% block content %}
<article class="post-detail">                                       <!-- 게시글 상세 정보 영역  // 게시글 상세 영역 -->
  <h1>{{ post.title }}</h1>                                           <!-- 게시글 제목 출력  // 제목 출력 -->
  <p>작성자: {{ post.writer.username }}</p>                           <!-- 작성자 정보 출력  // 작성자 출력 -->
  <div class="post-content">
    {{ post.content|safe }}                                           <!-- 내용 렌더링 (HTML 허용)  // 내용 출력 -->
  </div>
  
  <!-- 관련 이미지 출력 (있는 경우)  // 이미지 출력 -->
  {% if post.postimage_set.all %}
    <div class="post-images">
      {% for image in post.postimage_set.all %}
        <img src="{{ image.image.url }}" alt="게시글 이미지" style="max-width: 300px;">  <!-- 이미지 태그  // 이미지 태그 -->
      {% endfor %}
    </div>
  {% endif %}

  <!-- 좋아요(하모니) 버튼  // 좋아요 버튼 -->
  <div class="like-container" style="margin-top:20px;">             <!-- 버튼 감싸는 영역  // 감싸는 영역 -->
    <button id="like-btn" 
            data-post-id="{{ post.id }}" 
            data-model="GeneralPost"> 
      🎵 하모니(좋아요) <span id="like-count">{{ post.likes }}</span>  <!-- 아이콘 및 좋아요 수  // 좋아요 수 -->
    </button>
  </div>
  
  <a href="{% url 'community:home' %}" class="btn hover-effect">목록으로 돌아가기</a>   <!-- 목록 복귀 버튼  // 복귀 버튼 -->
</article>

<hr>                                                                    <!-- 구분선 추가  // 구분선 -->

<section class="comments-section">                                       <!-- 댓글 섹션 시작  // 댓글 섹션 시작 -->
  <h2>댓글</h2>                                                          <!-- 댓글 섹션 제목  // 댓글 제목 -->

  <!-- 댓글 입력 폼 시작  // 댓글 폼 시작 -->
  <form method="post" action="">                                           <!-- 폼 태그 (현재 URL에 전송)  // 폼 시작 -->
    {% csrf_token %}                                                     <!-- CSRF 토큰  // CSRF 토큰 -->
    {{ comment_form.as_p }}                                                <!-- 댓글 폼 필드 렌더링  // 폼 필드 -->
    <button type="submit" class="btn btn-primary">댓글 작성</button>         <!-- 제출 버튼  // 제출 버튼 -->
  </form>                                                                 <!-- 댓글 폼 끝  // 폼 끝 -->

  <!-- 댓글 목록 출력  // 댓글 목록 출력 -->
  {% if comments %}                                                       <!-- 댓글 존재 여부 체크  // 댓글 확인 -->
    {% for comment in comments %}                                         <!-- 각 댓글 반복  // 댓글 반복 -->
      <div class="comment" style="border: 1px solid #ccc; margin-top:10px; padding:10px;"> <!-- 댓글 컨테이너 스타일  // 댓글 스타일 -->
        <p>{{ comment.content }}</p>                                     <!-- 댓글 내용 출력  // 댓글 내용 -->
        <small>작성일: {{ comment.created_at|date:"Y-m-d H:i" }}</small>  <!-- 댓글 작성일 출력  // 작성일 -->
      </div>
    {% endfor %}
  {% else %}                                                              <!-- 댓글이 없을 경우  // 댓글 없음 -->
    <p>작성된 댓글이 없습니다.</p>                                          <!-- 댓글 없음 메시지  // 메시지 -->
  {% endif %}
</section>

{% endblock %}